# 2023/05/20

◆ 레지스터

CPU 내부의 작은 저장장치이며, 프로그램 속 명령어와 데이터는 실행 전후로 레지스터에 저장된다

레지스터는 여러 가지가 존재하지만, 대부분의 CPU가 공통적으로 사용하는 레지스터는 아래의 8가지이다

1. 프로그램 카운터
메모리에서 가져올 명령어의 주소를 저장 (메모리에서 읽어 들일 명령어의 주소)
'명령어 포인터' 라고 부르는 CPU도 있다

2. 명령어 레지스터
해석할 명령어를 저장 (방금 메모리에서 읽은 명령어)

3. 메모리 주소 레지스터
메모리의 주소를 저장, CPU가 읽고자 하는 주소를 주소 버스로 보낼 때 거치는 레지스터

4. 메모리 버퍼 레지스터
메모리와 주고받을 값을 저장 (데이터, 명령어), CPU가 정보를 데이터 버스로 주고받을 때 거치는 레지스터

5. 플래그 레지스터
연산 결과, 또는 CPU 상태에 대한 부가적인 정보 저장

6. 범용 레지스터
다양하고 일반적인 상황에서 자유롭게 사용하는 레지스터, 다양한 정보를 담을 수 있다

★특별한 주소 지정에 사용
7. 스택 포인터
스택 주소 지정 방식 : 스택과 스택 포인터를 이용한 주소 지정 방식
스택 포인터 : 스택의 꼭대기를 가리키는 레지스터 (스택이 어디까지 차 있는지에 대한 표시)

Stack 의 후입선출을 위해 마지막으로 저장된 값의 주소를 저장하는 것 같다
메모리 안에 스택처럼 사용할 수 있는 구역이 있다는데, 차후 운영체제를 공부 할 때 자세히 봐야겠다

★특별한 주소 지정에 사용
8. 베이스 레지스터
변위 주소 지정 방식 : 오퍼랜드 필드의 값 (변위) 과 특정 레지스터의 값을 더하여 주효 주소 얻기

레지스터의 값과, 오퍼랜드 필드에 저장된 주소를 더한 곳에 있는 데이터를 가리킨다

CPU마다 다르지만 크게 두 가지 방식으로 나뉘는데
1. 오퍼랜드 필드의 값 + 프로그램 카운터의 값으로 유효 주소 얻기
2. 오퍼랜드 필드의 값 + 베이스 레지스터의 값으로 유효 주소 얻기

1번은 상대 주소 지정 방식
프로그램 카운터가 가지고 있는 주소 값에서 n만큼 떨어진 주소를 지정한다

2번은 베이스 레지스터 주소 지정 방식
기준이 되는 주소 x번지에서 n만큼 떨어진 메모리의 주소를 지정한다




실행할 프로그램이 1000 ~ 1500번지를 사용한다고 할 때, 명령어 하나 당 하나의 메모리 번지를 차지하고 있다고 가정하면

첫 번째 주소부터 실행한다고 할 때

'프로그램 카운터' 는 1000번지를 가리키고 -> 

'메모리 주소 레지스터' 는 '프로그램 카운터' 가 가지고 있는 다음 주소 값을 복사한 후, 
주소 버스와 제어 버스의 메모리 읽기 신호를 같이 쏘아 준다 ->

읽은 메모리 주소의 값을 다시 데이터 버스를 통해 '메모리 버퍼 레지스터' 로 가져온다 ->

'프로그램 카운터' 는 1 증가하여 다음 메모리를 읽을 준비를 한다 ->

'명령어 레지스터' 에 '메모리 버퍼 레지스터' 의 값이 복사되어 연산에 사용할 명령을 처리할 준비를 한다

이런 식으로 순차적으로 실행이 된다.
다만, 순차적인 실행 흐름이 끊기는 경우도 존재하는데

1. 특정 메모리 주소로 실행 흐름을 이동하는 명령어를 실행 시
(JUMP, CONDITIONAL JUMP, CALL, RET)

2. 인터럽트 발생 시

3. 기타


인터럽트가 발생하면 순차적인 실행 흐름이 끊긴다는데, 인터럽트가 무엇인가 찾아봐야겠다

